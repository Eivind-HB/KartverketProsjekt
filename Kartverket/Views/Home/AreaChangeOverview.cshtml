@model List<Kartverket.Data.Case>
﻿<!--model Kartverket.Models.ChangeOverviewModel-->

@{
    ViewData["Title"] = "Overview";
}

<div class="page-container">
    <h1>Oversikt av registrerte endringer</h1>

    <div class="accordion-container">
        <!-- Issue Details Section -->
        <div class="accordion-item">
            <button class="accordion-header">
                Saks Detaljer
                <span class="accordion-icon">▼</span>
            </button>
            <div class="accordion-content">
                <table class="table">
                    <thead>
                        <tr>
                            <th>Saks ID</th>
                            <th>Saks Type</th>
                            <th>Saks Dato</th>
                            <th>GeoJson</th>
                            <th>Beskrivelse</th>  
                            <th>Bilde</th>
                        </tr>
                    </thead>
                    <tbody>
                        @foreach (var change in Model)
                        {
                                <tr>
                                    <td>@change.CaseNo</td>
                                    <td>@change.Issue_IssueNr</td>
                                    <td>@change.Date</td>
                                    <td>@change.LocationInfo</td>
                                    <td>@change.Description</td>
                                    <td>@change.Images</td>
                                </tr>
                        }
                    </tbody>
                </table>
            </div>
        </div>

        <!-- Location Details Section -->
        <!--<div class="accordion-item">
            <button class="accordion-header">
                Lokasjon Detaljer
                <span class="accordion-icon">▼</span>
            </button>
            <div class="accordion-content">
                <table class="table">
                    <thead>
                        <tr>
                            <th>Kommunenavn</th>
                            <th>Kommunenummer</th>
                            <th>Fylkesnavn</th>
                            <th>Fylkesnummer</th>
                        </tr>
                    </thead>
                    <tbody>
                        ATSYMBOLforeach (var change in Model.AreaChanges)
                        {
                                <tr>
                                    <td>ATSYMBOLchange.Kommunenavn</td>
                                    <td>ATSYMBOLchange.Kommunenummer</td>
                                    <td>ATSYMBOLchange.Fylkesnavn</td>
                                    <td>ATSYMBOLchange.Fylkesnummer</td>
                                </tr>
                        }
                    </tbody>
                </table>
            </div>
        </div>-->
    </div>


    <div class="map-change-container">
        <div id="map" class="map-section"></div>
    </div>
</div>

@section Scripts {
    <script src="~/js/leafletMap.js"></script>
    <script src="~/js/mapChanges.js"></script>

    <script>
        // Accordion functionality
        document.querySelectorAll('.accordion-header').forEach(button => {
            button.addEventListener('click', () => {
                const accordionContent = button.nextElementSibling;
                button.classList.toggle('active');

                if (accordionContent.style.display === 'block') {
                    accordionContent.style.display = 'none';
                } else {
                    accordionContent.style.display = 'block';
                }

                // Update map size when accordion changes
                map.invalidateSize();
            });
        });

        // Passes the serialized AreaChanges model data to the mapChanges function 
        var cases = List<Case>
        var drawnChanges = @Html.Raw(Json.Serialize(Model));
        initializeDrawnChanges(drawnChanges);


    </script>
}