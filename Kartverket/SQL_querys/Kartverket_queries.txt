CREATE DATABASE KartverketProject;

USE KartverketProject;

CREATE TABLE IF NOT EXISTS `KartverketProject`.`User` (
  `UserID` INT NOT NULL,
  `UserName` VARCHAR(20) NOT NULL,
  `Mail` VARCHAR(45) NULL,
  `Password` VARCHAR(45) NULL,
  PRIMARY KEY (`UserID`),
  UNIQUE INDEX `BrukerNr_UNIQUE` (`UserID` ASC) VISIBLE,
  UNIQUE INDEX `Mail_UNIQUE` (`Mail` ASC) VISIBLE)
ENGINE = InnoDB;

CREATE TABLE IF NOT EXISTS `KartverketProject`.`Issue` (
  `IssueNo` INT(2) NOT NULL,
  `IssueType` VARCHAR(20) NOT NULL,
  PRIMARY KEY (`IssueNo`),
  UNIQUE INDEX `SaksNr_UNIQUE` (`IssueNo` ASC) VISIBLE)
ENGINE = InnoDB;

CREATE TABLE IF NOT EXISTS `KartverketProject`.`KartverketEmployee` (
  `EmployeeID` INT NOT NULL,
  `PhoneNo` INT(8) NULL,
  `Mail` VARCHAR(45) NOT NULL,
  `Title` VARCHAR(45) NOT NULL,
  `Wage` INT NOT NULL,
  `Firstname` VARCHAR(45) NOT NULL,
  `Lastname` VARCHAR(45) NOT NULL,
  PRIMARY KEY (`EmployeeID`),
  UNIQUE INDEX `AnsattNr_UNIQUE` (`EmployeeID` ASC) VISIBLE,
  UNIQUE INDEX `TelefonNr_UNIQUE` (`PhoneNo` ASC) VISIBLE,
  UNIQUE INDEX `mail_UNIQUE` (`Mail` ASC) VISIBLE)
ENGINE = InnoDB;

CREATE TABLE IF NOT EXISTS `KartverketProject`.`Case` (
  `CaseNo` INT NOT NULL,
  `LocationInfo` GEOMETRY NOT NULL,
  `Description` LONGTEXT NOT NULL,
  `Date` DATE NOT NULL,
  `CaseWorker_CaseWorkerID` INT NOT NULL,
  `User_UserID` INT NOT NULL,
  `Issue_IssueNr` INT(2) NOT NULL,
  `Images` BLOB NULL,
  PRIMARY KEY (`CaseNo`, `User_UserID`, `Issue_IssueNr`, `CaseWorker_CaseWorkerID`),
  UNIQUE INDEX `SaksNr_UNIQUE` (`CaseNo` ASC) VISIBLE,
  INDEX `fk_Case_User_idx` (`User_UserID` ASC) VISIBLE,
  INDEX `fk_Case_Issue1_idx` (`Issue_IssueNr` ASC) VISIBLE,
  CONSTRAINT `fk_Case_User`
    FOREIGN KEY (`User_UserID`)
    REFERENCES `KartverketProject`.`User` (`UserID`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_Case_Issue1`
    FOREIGN KEY (`Issue_IssueNr`)
    REFERENCES `KartverketProject`.`Issue` (`IssueNo`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;

CREATE TABLE IF NOT EXISTS `KartverketProject`.`CaseWorkerOverview` (
  `CaseWorkerID` INT NOT NULL,
  `CaseWorkerList_Case_CaseNo` INT NOT NULL,
  `PaidHours` VARCHAR(10) NULL,
  PRIMARY KEY (`CaseWorkerID`, `CaseWorkerList_Case_CaseNo`),
  UNIQUE INDEX `CaseWorker ID_UNIQUE` (`CaseWorkerID` ASC) VISIBLE)
ENGINE = InnoDB;

CREATE TABLE IF NOT EXISTS `KartverketProject`.`CaseWorkerList` (
  `AmountWorkers` VARCHAR(45) NOT NULL,
  `Case_CaseNo` INT NOT NULL,
  `CaseWorkerOverview_CaseWorkerID` INT NOT NULL,
  PRIMARY KEY (`Case_CaseNo`, `CaseWorkerOverview_CaseWorkerID`),
  INDEX `fk_CaseWorkerList_CaseWorkerOverview1_idx` (`CaseWorkerOverview_CaseWorkerID` ASC) VISIBLE,
  CONSTRAINT `fk_CaseWorkerList_Case1`
    FOREIGN KEY (`Case_CaseNo`)
    REFERENCES `KartverketProject`.`Case` (`CaseNo`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_CaseWorkerList_CaseWorkerOverview1`
    FOREIGN KEY (`CaseWorkerOverview_CaseWorkerID`)
    REFERENCES `KartverketProject`.`CaseWorkerOverview` (`CaseWorkerID`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;

CREATE TABLE IF NOT EXISTS `KartverketProject`.`CaseWorker` (
  `CaseWorkerID` INT NOT NULL,
  `KartverketEmployee_EmployeeID` INT NOT NULL,
  `CaseWorkerList_Case_CaseNo` INT NOT NULL,
  PRIMARY KEY (`CaseWorkerID`, `CaseWorkerList_Case_CaseNo`, `KartverketEmployee_EmployeeID`),
  INDEX `fk_KartverketEmployee_has_Case_KartverketEmployee1_idx` (`KartverketEmployee_EmployeeID` ASC) VISIBLE,
  UNIQUE INDEX `CaseWorker ID_UNIQUE` (`CaseWorkerID` ASC) VISIBLE,
  INDEX `fk_CaseWorker_CaseWorkerList1_idx` (`CaseWorkerList_Case_CaseNo` ASC) VISIBLE,
  CONSTRAINT `fk_KartverketEmployee_has_Case_KartverketEmployee1`
    FOREIGN KEY (`KartverketEmployee_EmployeeID`)
    REFERENCES `KartverketProject`.`KartverketEmployee` (`EmployeeID`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_CaseWorker_CaseWorkerList1`
    FOREIGN KEY (`CaseWorkerList_Case_CaseNo`)
    REFERENCES `KartverketProject`.`CaseWorkerList` (`Case_CaseNo`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;
